<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Shu-Hsien Cho</title>
  
  <subtitle>Ph.D. Student in Biostatistics, University of Texas MD Anderson UTHealth Graduate School of Biomedical Sciences</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://shuhsiencho.github.io/"/>
  <updated>2023-01-10T20:41:31.394Z</updated>
  <id>https://shuhsiencho.github.io/</id>
  
  <author>
    <name>Shu-Hsien Cho</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Implementations of the Monte Carlo EM Algorithm</title>
    <link href="https://shuhsiencho.github.io/posts/imcem/"/>
    <id>https://shuhsiencho.github.io/posts/imcem/</id>
    <published>2023-01-11T00:00:00.000Z</published>
    <updated>2023-01-10T20:41:31.394Z</updated>
    
    <content type="html"><![CDATA[<p>This note is based on the <strong><a href="https://www.jstor.org/stable/1391097">R. Levine and G. Casella (2001), Implementations of the Monte Carlo EM Algorithm, Journal of Computational and Graphical Statistics</a></strong></p><a id="more"></a><h2 id="monte-carlo-em-algorithm">Monte Carlo EM Algorithm</h2><h3 id="overview">Overview</h3><p>MCEM is a modification of the EM algorithm where the conditional expectation of log-likelihood in the E-step is computed numerically through Monte Carlo simulations, and MCMC sampler (Gibbs Sampler / Metropolis-Hasting) is the most flexible approach for Monte Carlo sample.</p><h3 id="target">Target</h3><ul><li><strong>Minimizing computational cost</strong> from non-closed form E-step (Problem from Wei(1990) original paper) to approximate the posterior: importance sampling whereby samples drawn during previous EM iterations are recycled</li><li><strong>Choosing sample size</strong>: regenerate approximate samples by subsampling the generated MCMC sample during different renewal periods.</li></ul><h3 id="existing-paper">Existing paper</h3><ul><li>Booth an Hobert(1990): Gauge error by increase sample size as algorithm converges, but requires i.i.d. samples or importance weighted.</li><li>MCMC: Though the random variates are dependent in such a scenario, the E-step estimator is still unbiased and approaches the true value as the sample size increases.</li></ul><h3 id="notation">Notation</h3><ul><li>Observed data: <span class="math inline">\(\mathbf{y} = (y_1,\cdots,y_n)^T\)</span></li><li>Parameters: <span class="math inline">\(\mathbf{\Psi}\)</span></li><li>MLE is simpler to compute on the data augmented by a set of latent variables <span class="math inline">\(\mathbf{u}=(u_1,\cdots,u_q)^T\)</span></li><li>conditional distribution of the latent variables: <span class="math inline">\(g\left(\mathbf{u}|\mathbf{y,\Psi^{(r)}}\right)\)</span> with iteration <span class="math inline">\(r\)</span></li><li>EM: Complete data likelihood: <span class="math inline">\(Q\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)=E_{\hat{\mathbf{\Psi}}^{(r)}}\{\text{ln} f(\mathbf{y,u}|\mathbf{\Psi})|\mathbf{y}\}=\int\text{ln} f(\mathbf{y,u}|\mathbf{\Psi})g\left(\mathbf{u}|\mathbf{y,\Psi^{(r)}}\right)d\mathbf{u}\)</span> and maximize it over <span class="math inline">\(\mathbf{\Psi}\)</span></li><li>Obtain a sample <span class="math inline">\(\mathbf{u^{(r)}_1},\cdots,\mathbf{u^{(r)}_m}\)</span> from conditional distribution, the expectation can be estimated by Monte Carlo sum <span class="math inline">\(Q\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)=\dfrac{1}{m}\sum\limits^m_{t=1}\text{ln}f\left(\mathbf{y,u^{(r)}_t|\Psi}\right)\)</span></li><li><span class="math inline">\(m\)</span> denotes the dependence of this estimator on the MC sample size.</li></ul><p>So, how could we obtain a random sample from <span class="math inline">\(g\left(\mathbf{u}|\mathbf{y,\Psi}\right)\)</span> , and how do we choose <span class="math inline">\(m\)</span>?</p><h3 id="importance-sampling">Importance Sampling</h3><p>Drawing an MCMC sample each iteration of the EM algorithm could be prohibitively costly particularly for large <span class="math inline">\(m\)</span>.</p><ul><li>Importance weight <span class="math inline">\(w_t=\dfrac{g\left(\mathbf{u}_t|\mathbf{y,\Psi^{(r)}}\right)}{g\left(\mathbf{u}_t|\mathbf{y,\Psi^{(0)}}\right)}=\dfrac{L(\mathbf{\hat{\Psi}^{(r)}|u_t,y}))/L(\mathbf{\hat{\Psi}^{(r)}|y})}{L(\mathbf{\hat{\Psi}^{(0)}|u_t,y})/L(\mathbf{\hat{\Psi}^{(0)}|y})}\)</span> corrects the original sample <span class="math inline">\(\mathbf{u}\)</span> with the new information we have at iteration <span class="math inline">\(r\)</span></li><li>How much expense do we save? The expense saving with respect to the weights are not dependent on the unknown likelihood <span class="math inline">\(L(\mathbf{\Psi|y})\)</span> because it would be cancelled</li><li>Reasonable choice: <span class="math inline">\(Q_m\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)=\dfrac{\sum\limits^m_{t=1}w_t\text{ln}f\left(\mathbf{y,u^{(r)}_t|\Psi}\right)}{\sum\limits^m_{i=1}w_t}=\dfrac{\sum\limits^m_{t=1}w&#39;_t\text{ln}f\left(\mathbf{y,u_t|\Psi}\right)}{\sum\limits^m_{i=1}w&#39;_t}\)</span></li><li><span class="math inline">\(w&#39;_t=\dfrac{L(\mathbf{\hat{\Psi}^{(r)}|u_t,y})}{L(\mathbf{\Psi^{(0)}|u_t,y})}\)</span></li><li>The reasonable choice has smaller MSE than the below one (Liu 1996 and Casella 1998).</li><li>Another choice of important sampling: <span class="math inline">\(Q_m\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)=\dfrac{1}{m}\sum\limits^m_{t=1}w_t\text{ln}f\left(\mathbf{y,u_t|\Psi}\right)\)</span>. This would not affect the EM because the normalizing constant <span class="math inline">\(\dfrac{L(\mathbf{\Psi^{(0)}|y})}{L(\mathbf{\hat{\Psi}^{(r)}|y})}\)</span> only depends on initial value and updated estimate with iteration <span class="math inline">\(r\)</span> and does not involve the maximization. Use the reasonable one could avoid calculation of normalizing constant when choosing m.</li><li>Burn-in in first few iteration: This approach fails when the estimates with <span class="math inline">\(r\)</span> iteration is too far from the initial value. The target density would be close enough to have small variance. Burn-in time is problem specific depending on how close we need to be to the MLE in order to obtain stable importance weights in subsequent M-steps. Trial runs of the EM algorithm with importance sampling, gauging the variability in the importance weights as the algorithm converges, will provide the user with an idea for the appropriate burn-in time.</li></ul><h3 id="algorithm">Algorithm</h3><ol type="1"><li>Initialize <span class="math inline">\(m\)</span> and <span class="math inline">\(\mathbf{\Psi}^{(0)}\)</span></li><li>Generate <span class="math inline">\(\mathbf{u_1},\cdots,\mathbf{u_m}\sim g\left(\mathbf{u}|\mathbf{y,\Psi^{(0)}}\right)\)</span> via MCMC</li><li>At iteration <span class="math inline">\(r+1\)</span>, compute the importance weight <span class="math inline">\(w_t=\dfrac{L(\mathbf{\hat{\Psi}^{(r)}|u_t,y})}{L(\mathbf{\Psi^{(0)}|u_t,y})}\)</span></li><li>E-step: estimate <span class="math inline">\(Q\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)\)</span> by <span class="math inline">\(Q_m\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)=\dfrac{\sum\limits^m_{t=1}w_t\text{ln}f\left(\mathbf{y,u_t|\Psi}\right)}{\sum\limits^m_{i=1}w_t}\)</span></li><li>M-step: <span class="math inline">\(\max\limits_{\Psi}Q_m\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)\)</span> to obtain <span class="math inline">\(\hat{\mathbf{\Psi}}^{(r+1)}\)</span></li><li>MC error estimation:<ol type="1"><li>Compute for each <span class="math inline">\(j=1,\cdots,s\)</span>, <span class="math inline">\(\hat\mu_{m;j}=\sum\limits^m_{t=1}w_t\dfrac{\partial}{\partial \psi(j)}\text{ln}f\left(\mathbf{y,u_t|\Psi}\right)/\sum\limits^m_{t=1}w_t\)</span> by plugging in <span class="math inline">\(\mathbf{\Psi}=\hat{\mathbf{\Psi}}^{(r+1)}\)</span></li><li>Compute for each <span class="math inline">\(j=1,\cdots,s\)</span>, <span class="math inline">\(\hat{v}_{m;j}=\sum\limits^m_{t=1}w_t\left[\dfrac{\partial}{\partial \psi(j)}\text{ln}f\left(\mathbf{y,u_t|\Psi}\right)\right]^2/\left(\sum\limits^m_{t=1}w_t-\hat\mu_{m;j}^2\right)\)</span> by plugging in <span class="math inline">\(\mathbf{\Psi}=\hat{\mathbf{\Psi}}^{(r+1)}\)</span></li><li>Obtain the <span class="math inline">\((1-\alpha)\)</span> confidence interval about <span class="math inline">\(Q^{(1)}_j\left(\mathbf{\Psi}|\hat{\mathbf{\Psi}}^{(r)}\right)\)</span> by the above mean and variance from standard normal distribution.</li></ol></li><li>Obtain subsampling instants <span class="math inline">\(t_k=x_1+\cdots+x_k\)</span> where <span class="math inline">\(x_k-1\sim Poi(\nu_k), k=1,\cdots,N\)</span> and <span class="math inline">\(N=\sup\{n;t_n\leq m\}\)</span></li><li>If <span class="math inline">\(Q^{(1)}_m\left(\hat{\mathbf{\Psi}}^{(r)}|\mathbf{\Psi}^{(r-1)}\right)\)</span> lies in confidence interval, then<ol type="1"><li>Set <span class="math inline">\(m_o=m\)</span></li><li>Set <span class="math inline">\(m=m_o+gauss(m_o+c)\)</span> for some <span class="math inline">\(c&gt;0\)</span></li><li>Obtain <span class="math inline">\(\mathbf{u_{m_o+1}},\cdots,\mathbf{u_m}\sim g\left(\mathbf{u}|\mathbf{y,\Psi^{(0)}}\right)\)</span></li></ol></li><li>Compute for each <span class="math inline">\(j=1,\cdots,s\)</span>, <span class="math inline">\(Q^{(1)}_{m;j}\left(\hat{\mathbf{\Psi}}^{(r+1)}|\hat{\mathbf{\Psi}}^{(r)}\right)=\sum\limits^N_{k=1}w_{t_k}\dfrac{\partial}{\partial \psi(j)}\text{ln}f\left(\mathbf{y,u_{t_k}|\Psi}\right)/\sum\limits^m_{t=1}w_{t_k}\)</span> by plugging in <span class="math inline">\(\mathbf{\Psi}=\hat{\mathbf{\Psi}}^{(r+1)}\)</span></li><li>Repeat step 3 to step 9 until converge</li></ol><h3 id="burn-in-steps">Burn-in steps</h3><p>run burn-in for one minutes</p><ol type="1"><li>Set importance weights <span class="math inline">\(w_t = 1, \forall t=1,\cdots,m\)</span> at iteration <span class="math inline">\(b\)</span></li><li>Generate <span class="math inline">\(\mathbf{u_1},\cdots,\mathbf{u_m}\sim g\left(\mathbf{u}|\mathbf{y,\Psi^{(b)}}\right)\)</span> via MCMC</li><li>Run E and M step above with <span class="math inline">\(r=b\)</span></li><li>Repeat Steps 2 and 3 for <span class="math inline">\(B\)</span> burn-in iterations.</li><li>Reinitialize <span class="math inline">\(\mathbf{\Psi}^{(0)}=\mathbf{\Psi}^{(B)}\)</span></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This note is based on the &lt;strong&gt;&lt;a href=&quot;https://www.jstor.org/stable/1391097&quot;&gt;R. Levine and G. Casella (2001), Implementations of the Monte Carlo EM Algorithm, Journal of Computational and Graphical Statistics&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Note" scheme="https://ShuHsienCho.github.io/categories/Note/"/>
    
    
      <category term="Note" scheme="https://ShuHsienCho.github.io/tags/Note/"/>
    
      <category term="EM Algorithm" scheme="https://ShuHsienCho.github.io/tags/EM-Algorithm/"/>
    
      <category term="Monte Carlo" scheme="https://ShuHsienCho.github.io/tags/Monte-Carlo/"/>
    
      <category term="DeMiX-NB" scheme="https://ShuHsienCho.github.io/tags/DeMiX-NB/"/>
    
  </entry>
  
  <entry>
    <title>因果推論筆記（二）：Causal Effect</title>
    <link href="https://shuhsiencho.github.io/posts/causal2/"/>
    <id>https://shuhsiencho.github.io/posts/causal2/</id>
    <published>2021-02-05T00:00:00.000Z</published>
    <updated>2021-06-06T07:31:30.298Z</updated>
    
    <content type="html"><![CDATA[<h2 id="intro">Intro</h2><p>上一篇筆記中簡單敘述因果推論的重要性，以及與統計推論結合如何實現，這份筆記將會從數學符號起手，來介紹counterfactual的架構，並且得到causal effect。在開始之前先舉個實際上的例子：我們想要評估炎性乳腺癌 (Inflammatory breast cancer)的病患中，如果施行三合一療法 (<span class="math inline">\(S\)</span>)後，存活與否 (<span class="math inline">\(Y\)</span>) 的差別。下面將會以這個舉例貫穿全文。</p><a id="more"></a><h2 id="counterfactual-notation-and-average-causal-effect">Counterfactual notation and Average causal effect</h2><p>先回到統計上的符號，在統計中通常大寫代表了隨機變數 (random variables)，因此我們在建構這些符號時，也是以隨機變數的精神來思考。首先我們會有兩個平行宇宙，在第一個宇宙中某病人施行了三合一療法，被我們標記為<span class="math inline">\(Y_i(s=1)\)</span>，即使是在這個施行三合一療法的宇宙中，病人是否存活仍然存在著不確定性，亦即<span class="math inline">\(Y_i(s=1)\)</span>也是一個隨機變數，我們會以一個機率模型描述他；同理，在另一個平行宇宙中該病人並未施行三合一療法，我們將其標為另一個隨機變數<span class="math inline">\(Y_i(s=0)\)</span>，若<span class="math inline">\(Y_i(s=1)-Y_i(s=0)\neq 0\)</span>，即是有<strong>individual causal effect</strong>，而這裡的<span class="math inline">\(Y(s)\)</span>，通常稱之為<strong>counterfactual outcome</strong>或是<strong>potential outcome</strong>。然而，我們僅有接受治療或未接受治療中的一個情況發生，若某病人實際上接受治療 (<span class="math inline">\(S\)</span>=1)，則counterfactual outcome中 <span class="math inline">\(Y_i(s=1)=Y_i|(S=1)\)</span>（e.g. 具有相同的p.d.f.），也就是我們觀察到的outcome等於counterfactual outcome，這性質我們稱之為<strong>causal consistency</strong>，以白話文來敘述就是如果某病人在物理世界中接受某個治療，平行宇宙中同樣接受治療的該病人會具有相同的歷程。</p><p>由於不可能在現實中找到同一個人同時接受與不接受治療，因此<span class="math inline">\(Y_i(s=1)\)</span>與<span class="math inline">\(Y_i(s=0)\)</span>必然有一個是觀察不到(missing data，同樣的因果推論也是在處理missiing data的問題！) ，那就無法得到這個病人的individual causal effect，此處我們需要<strong>Average causal effect</strong>來協助我們找到<strong>群體</strong>治療與否的影響，也就開始會有機率與統計的介入，此處除了一樣需要<strong>randomization</strong>來確保兩個不同治療之下的病人群體是類似的之外，也需要這個<strong>群體足夠大</strong>以滿足大樣本性質來幫助我們找到類似的人。Average causal effect的定義相當簡單，由於我們推論的是群體資訊，因此average causal effect的關係式為<span class="math inline">\(P[Y(s=1)]\neq P[Y(s=0)]\)</span>，又或者是<span class="math inline">\(E[Y(s=1)]\neq E[Y(s=0)]\)</span>，更廣義的來說，我們也可以用中位數或者是empirical distribbution來定義average causal effect，只要causal effect是<strong>兩個不同counterfactual outcome各自的marginal distribution的函數相互比較</strong>即可。</p><h2 id="causal-effect-measure-and-association-measure">Causal effect measure and Association measure</h2>有了前述的關係式，我們得以創造因果推論上的假說檢定<span class="math inline">\(H_0: P[Y(s=1)=1]= P[Y(s=0)=1]\)</span>，方便我們量測average causal effect的estimand有以下幾種：<div><span class="math display">\[\begin{cases}\text{Causal risk difference:} &amp;P[Y(s=1)=1]- P[Y(s=0)=1]=0\\\text{Causal risk ratio:} &amp;\dfrac{P[Y(s=1)=1]}{P[Y(s=0)=1]}=1\\\text{Causal odds ratio:} &amp;\dfrac{P[Y(s=1)=1]/P[Y(s=1)=0]}{P[Y(s=0)=1]/P[Y(s=0)=0]}=1\\\text{Number needed to treat:} &amp;NNT=\dfrac{-1}{P[Y(s=1)=1]- P[Y(s=0)=1]}\end{cases}\]</span></div>然而，這跟平常所學的似乎不太一樣？考慮association的上述estimands可以表示為：<div><span class="math display">\[\begin{cases}\text{risk difference:} &amp;P[Y=1|S=1]- P[Y=1|S=0]=0\\\text{risk ratio:} &amp;\dfrac{P[Y=1|S=1]}{P[Y=1|S=0]}=1\\\text{odds ratio:} &amp;\dfrac{P[Y=1|S=1]/P[Y=0|S=1]}{P[Y=1|S=0]/P[Y=0|S=0]}=1\end{cases}\]</span></div><p>以下借用過去的投影片來描述這兩者有何不同之處</p><p><img src="/posts/causal2/causal2/1.png"></p><p>物理世界中我們能觀察到的資料就是左邊的方形，我們可以看到如果是相關性，我們是在比較<strong>觀察到不同<span class="math inline">\(S\)</span>條件下個別的<span class="math inline">\(Y\)</span></strong>，而因果則是將相關性比較中缺漏的部分補成完整的方形，也就是在比較<strong>如果整個群體在不同<span class="math inline">\(S\)</span>條件下的<span class="math inline">\(Y\)</span></strong></p><p><img src="/posts/causal2/causal2/2.png"></p><p>因此若是觀察到的資料會因為<span class="math inline">\(S\)</span>的關係而產生不一樣的分配（如方形中的藍點），很顯然能發現相關性在此刻不等於因果</p><p><img src="/posts/causal2/causal2/3.png"></p><p>而<span class="math inline">\(S\)</span>若對於藍點的分配並無影響，也就是如果沒有干擾因子，則相關性就能等於因果！</p><p>(To be continued)</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;intro&quot;&gt;Intro&lt;/h2&gt;
&lt;p&gt;上一篇筆記中簡單敘述因果推論的重要性，以及與統計推論結合如何實現，這份筆記將會從數學符號起手，來介紹counterfactual的架構，並且得到causal effect。在開始之前先舉個實際上的例子：我們想要評估炎性乳腺癌 (Inflammatory breast cancer)的病患中，如果施行三合一療法 (&lt;span class=&quot;math inline&quot;&gt;\(S\)&lt;/span&gt;)後，存活與否 (&lt;span class=&quot;math inline&quot;&gt;\(Y\)&lt;/span&gt;) 的差別。下面將會以這個舉例貫穿全文。&lt;/p&gt;
    
    </summary>
    
    
      <category term="中文" scheme="https://ShuHsienCho.github.io/categories/%E4%B8%AD%E6%96%87/"/>
    
      <category term="筆記" scheme="https://ShuHsienCho.github.io/categories/%E4%B8%AD%E6%96%87/%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Note" scheme="https://ShuHsienCho.github.io/tags/Note/"/>
    
      <category term="Causal" scheme="https://ShuHsienCho.github.io/tags/Causal/"/>
    
  </entry>
  
  <entry>
    <title>因果推論筆記（一）：What is Causality?</title>
    <link href="https://shuhsiencho.github.io/posts/causal1/"/>
    <id>https://shuhsiencho.github.io/posts/causal1/</id>
    <published>2021-02-03T00:00:00.000Z</published>
    <updated>2021-06-06T07:31:30.298Z</updated>
    
    <content type="html"><![CDATA[<h2 id="intro">Intro</h2><p>有鑒於過去在中研院擔任RA時，並沒有建立良好的習慣來記錄自己三年來的所學，而這個網站為了培養這個習慣之餘，我也希望能一點點的把過去所學建檔，並且在未來能有所用，因此接下來會有一系列我個人對於因果推論的摘要，以及因果中介分析論文的內容介紹。</p><p>當然，近來因果推論在AI的領域相當盛行，而對這領域有些了解的人必然知道，事實上在40年前就已經開始有電腦科學家在進行因果推論的研究，而他們是使用一種稱為Directed Acyclic Graphs (DAG) 的模式來研究AI，而其中最著名的人就屬在UCLA資工系任教的Dr. Judea Pearl。但在流行病學與統計學領域中也有兩位相當著名的教授，分別是Dr. James Robins 以及Dr. Don Rubin兩位在Harvard的老師（甚至兩位老師的觀點也有些不同），而接下來的介紹會更接近<strong>流行病學與統計學</strong>中使用的因果推論為主，因此內容會包含較多的符號與統計概念，如果對資工以及AI有興趣的人可以去閱讀Dr. Judea Pearl所寫的“Causality”，或者是更為通俗的“因果革命”。</p><a id="more"></a><h2 id="overview">Overview</h2><p>在因果推論中，了解因果之前必須要先了解因果關係、相關、以及交互作用的差異，了解這些就能對不直觀的矛盾找出更合理的解釋，如Simpson Paradox。當我們有了清楚的分界，接下來就能將因果推論擴展到最常用的兩個主題：隨機試驗以及觀察性研究，並且介紹因果推論在這兩個主題上的各種應用，包含前述的DAG，以及經常出現的選擇偏誤跟干擾因子在因果推論中的處理等等。界定好上述問題後，可以將因果推論擴展到因果中介分析，以及在經濟學、政治學以及遺傳學中常見的工具變量 (Instrumental Variable，在遺傳學中則為Mendelian Randomization)，最後則會基於因果中介分析來介紹一些閱讀過或者是我有參與的論文。</p><h2 id="what-is-causality">What is Causality?</h2><p>人生而為人永遠都在尋找因與果，不管是俗諺中的「種什麼因，得什麼果」、佛教信仰中的「因果輪迴」、乃至於今天學習科學中的「因果關係」，再再證明人類對因果推論的本能與渴求，可大多數時候我們不求甚解，經常性地將僅僅是眼睛看見的資訊（亦即統計上的observation）得到的關係作為因果，造成了統計上的名言：「相關並不代表因果」，然而我們卻缺乏適當的數學工具在統計中描述因果並解釋之。雖然我們可以透過日常的事件來思考甚至回答兩件事情是否為因果，例如：疾病治療的效果、冰淇淋銷量與鯊魚攻擊數量的正相關、銷售額的增加要歸因於廣告還是價格等，事實上想要在數學上建立因果事實上需要更多的條件，如藥廠在進行藥物開發與療效評估時，必須要創造出隨機控制試驗 (Randomized Control Trial) 這樣近乎完美的試驗，甚至還得複製數次才得以找出因果關係，而這件事恰恰說明因果推論的核心觀念：<strong>控制所有變因下的可複製結果</strong></p><p>想要創造出這樣完美的實驗，我們必須要先有「<strong>反事實架構 (Counterfactual framework)</strong>」 以及「<strong>介入 (Intervention)</strong>」，counterfactual以中文常見的語彙來說是「如果做了什麼『介入』，會怎樣？」也就是我們創造了另外一個平行世界來推論，然後透過intervention來推論因果是否存在。例如：雖然我們都說雞啼之後太陽就會升起，但我們可以直覺得知在另外一個平行世界中，即使今天把雞燉成雞湯，太陽依然照常升起。我們也能從這樣的例子知道，因果關係同時也潛藏時間的先後順序性，以及<strong>因-&gt;果</strong>這樣的一個箭頭方向。為什麼生物統計、醫學、流行病學、試驗等等方法論牽涉更多的因果推論？因為人只有一條生命與一個歷程，我們沒有辦法在現實的觀察中得到另外一個一模一樣的你跟我，加上在醫學的研究中不能出差錯，畢竟人死不能復生，所以在這方面就需要更嚴謹的因果推論架構，不像做機器學習可以更有彈性的調整參數而不對真實人命有影響（也不會被告），事實上任何的預測方法其實都<strong>未必需要</strong>因果推論，大部分現存的機器學習方法也很難辯證干擾因子以及偏誤。</p><p>當我們知道了因果推論的重要性之後，下一步則討論如何結合因果推論與統計推論。首先回到統計的觀念，進行推論之前我們必須要有目標的<strong>estimand</strong>，這個待估計的量可以讓我們用估計量 (estimator) 來近似我們想從資料中推斷出的母體資訊，但在創造estimand時，比起使用機率與模型，我們更多時候是優先考慮找到一個<strong>想得到的資訊</strong>的表現形式（如我們想衡量療法能降低多少死亡風險），再去使用模型來想辦法得到estimator這個表現形式（如log hazard ratio），才得到估計值 (estimate) 這個近似值，最後就是把因果的直觀與統計推論連接，並且在有共識的反事實框架下有效地透過因果來溝通。因此，在定義問題與闡釋因果的階段，我們必須在<strong>考慮資料特性前</strong>就先評估因果，而不是優先考慮可用模型，並且適當的使用一些<strong>無須考慮資料特性的因果假設</strong>來創造一個前述的<strong>平行世界</strong>，這些假設我其實很常稱呼為<strong>多拉A夢的時光機</strong>，而這些假設會在後面提到。</p><h2 id="conclusion">Conclusion</h2><p>綜上所述，我們必須了解到因果推論是發生在統計推論之前，並且我們不會因為有了Causal inference讓我們的統計推論得到天翻地覆的變化或是發展出全新的統計量成為causal一方之霸，也不是因為理解causal而開嘴任何的統計方法都沒有因果關係或不符合假設，畢竟我們如果把研究放到量子糾纏的層次，永遠都沒辦法排除掉那隱含的不確定性。因果推論的科學問題更著重在確保怎樣的條件與假設下，使得因果成立，並且得到我們有興趣且具有因果關係的標的，我想這才是因果推論的精髓。</p><p>(To be continued)</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;intro&quot;&gt;Intro&lt;/h2&gt;
&lt;p&gt;有鑒於過去在中研院擔任RA時，並沒有建立良好的習慣來記錄自己三年來的所學，而這個網站為了培養這個習慣之餘，我也希望能一點點的把過去所學建檔，並且在未來能有所用，因此接下來會有一系列我個人對於因果推論的摘要，以及因果中介分析論文的內容介紹。&lt;/p&gt;
&lt;p&gt;當然，近來因果推論在AI的領域相當盛行，而對這領域有些了解的人必然知道，事實上在40年前就已經開始有電腦科學家在進行因果推論的研究，而他們是使用一種稱為Directed Acyclic Graphs (DAG) 的模式來研究AI，而其中最著名的人就屬在UCLA資工系任教的Dr. Judea Pearl。但在流行病學與統計學領域中也有兩位相當著名的教授，分別是Dr. James Robins 以及Dr. Don Rubin兩位在Harvard的老師（甚至兩位老師的觀點也有些不同），而接下來的介紹會更接近&lt;strong&gt;流行病學與統計學&lt;/strong&gt;中使用的因果推論為主，因此內容會包含較多的符號與統計概念，如果對資工以及AI有興趣的人可以去閱讀Dr. Judea Pearl所寫的“Causality”，或者是更為通俗的“因果革命”。&lt;/p&gt;
    
    </summary>
    
    
      <category term="中文" scheme="https://ShuHsienCho.github.io/categories/%E4%B8%AD%E6%96%87/"/>
    
      <category term="筆記" scheme="https://ShuHsienCho.github.io/categories/%E4%B8%AD%E6%96%87/%E7%AD%86%E8%A8%98/"/>
    
    
      <category term="Note" scheme="https://ShuHsienCho.github.io/tags/Note/"/>
    
      <category term="Causal" scheme="https://ShuHsienCho.github.io/tags/Causal/"/>
    
  </entry>
  
  <entry>
    <title>Inference on Selected Subgroups in Clinical Trials</title>
    <link href="https://shuhsiencho.github.io/posts/issct/"/>
    <id>https://shuhsiencho.github.io/posts/issct/</id>
    <published>2021-01-28T00:00:00.000Z</published>
    <updated>2021-01-29T14:39:23.656Z</updated>
    
    <content type="html"><![CDATA[<p>This note is based on the <strong><a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1740096">X. Guo and X. He (2020), Inference on Selected Subgroups in Clinical Trials, Journal of American Statistical Association</a></strong></p><a id="more"></a><h2 id="subgroup-analyses-and-selection-bias-overview">Subgroup Analyses and Selection bias Overview</h2><p>Subgroup analyses figure out promising treatments to some subgroups. In practice, subgroup analyses consists of two steps: subgroup identification and subgroup confirmation. In the identification step, researchers looks for the best selected subgroup which comes from domain considerations or data-driven. The existing data-driven identification methods are mostly machine-learning based or model based. The confirmation step provides an inference for possibly additional trials on the promising subgroup. Generally, The inference to the selected subgroup may lead to an <strong>overly optimistic evaluation</strong>, which is called subgroup selection bias. This kind of bias is originated from the selection mechanism of <span class="math inline">\(\max\limits_{i=1,\cdots,k}(\beta_i)\)</span>. Some of the existing methods for subgroup confirmation might be conservative, without theoretical justification, or model-dependent. Thus, this paper proposes a (data-adaptive) de-biasing bootstrap estimate and a valid one-sided confidence bound.</p><h2 id="procedure">Procedure</h2><p>For predifined subgroups, the interested estimators are the  <span class="math inline">\(\beta_s\)</span> (the true effect size of the subgroup with the largest estimated effect) and  <span class="math inline">\(\beta_{\max}\)</span> (the largest true subgroup effect size). The procedure is:</p><ol type="1"><li>Obtain the largest modified bootstrapped subgroup effect <span class="math inline">\(\beta^*_{\max,\text{modified}}=\max\limits_{i=1,\cdots,k}(\beta^*_i+d_i)\)</span> with modification <span class="math inline">\(d_i=(1-n^{r-0.5})(\hat\beta_{\max}-\hat\beta_i)\)</span></li><li>Construct the bootstrap confidence interval <span class="math inline">\(\hat\beta_{\max}\pm c_\alpha/\sqrt{n}\)</span> with <span class="math inline">\(c_{\alpha}=quantile(\sqrt{n}(\max\limits_{i=1,\cdots,k}(\beta^*_{i,b}+d_i)-\hat\beta_{\max}),1-\alpha)\)</span> (asymptotically sharp interval for <span class="math inline">\(\beta_s\)</span>).</li><li>Derive the bias-reduced estimator <span class="math inline">\(\hat\beta_{\max,\text{reduced}}=\hat\beta_{\max}-E^*[\beta^*_{\max,\text{modified}}-\hat\beta_{\max}]\)</span></li><li>For data-adaptive <span class="math inline">\(r\)</span>, tune <span class="math inline">\(r\)</span> with cross validation and bias-reduced estimator.</li></ol><p>While considering the post-hoc subgroup identification, the procedure is similar to the predefined subgroup identification but no data-adaptive selection for <span class="math inline">\(r\)</span>.</p><h2 id="possible-extention">Possible Extention</h2><p>This method is useful for homogeneous subgroups, because the subgroup selection bias in the homogeneous subgroups might be larger than one in the heterogeneous subgroups. When the subgroup effects are heterogeneous, the naive approach of subgroup identification provide an efficient enough result with less empirical bias. However, the <strong>tradeoff among the tuning parameter <span class="math inline">\(r\)</span>, heterogeneity, and number of subgroups has not been discussed</strong>.</p><p>With the simulation provided in this paper, the bias and coverage get worse when the number of subgroups or <span class="math inline">\(r\)</span> gets large. When <span class="math inline">\(r\)</span> gets large, it means that the effect modification <span class="math inline">\(d\)</span> goes to 0. We could also discover that the empirical bias with small <span class="math inline">\(r\)</span> performs better than large <span class="math inline">\(r\)</span> in homogeneous subgroups setting. However, this situation is reversed in heterogeneous setting. Thus, the relationship between modification, heterogeneity, and number of subgroups might be a potential issue to work on.</p><p>Another possible extension associates with the <strong>confounding adjustment</strong>, especially for trial data and observational studies. This method allows overlapped subgroup; that is, we cannot think the subgroup as the stratification. With confounding adjustment, the subgroup effect size should be reconsidered.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This note is based on the &lt;strong&gt;&lt;a href=&quot;https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1740096&quot;&gt;X. Guo and X. He (2020), Inference on Selected Subgroups in Clinical Trials, Journal of American Statistical Association&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Note" scheme="https://ShuHsienCho.github.io/categories/Note/"/>
    
    
      <category term="Note" scheme="https://ShuHsienCho.github.io/tags/Note/"/>
    
      <category term="Subgroup Analysis" scheme="https://ShuHsienCho.github.io/tags/Subgroup-Analysis/"/>
    
      <category term="Clinical Trial" scheme="https://ShuHsienCho.github.io/tags/Clinical-Trial/"/>
    
  </entry>
  
  <entry>
    <title>Survival Analysis Note</title>
    <link href="https://shuhsiencho.github.io/posts/survivalnote/"/>
    <id>https://shuhsiencho.github.io/posts/survivalnote/</id>
    <published>2021-01-24T01:00:00.000Z</published>
    <updated>2021-06-06T07:31:30.296Z</updated>
    
    <content type="html"><![CDATA[<p>This lecture note is based on UTMDA/GSBS GS01 1023: Survival Analysis. All the lecture notes will provide an introduction to associated theory for the analysis of censored failure time data. Becuase this course mainly discuss the commonly-used methods with heuristic arguments and intuitive explanation of their properties, I will also include my own reading notes on incomplete observations and other types of continuous-time processes such as arise with competing risks data, multivariate failure time data, counting processes approaches, martingale and large-sample properties of estimators and tests, and some possible extensions.</p><a id="more"></a><h2 id="chapter-1-introduction">Chapter 1: Introduction</h2><p><a href="Ch1-Introduction.pdf">File</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This lecture note is based on UTMDA/GSBS GS01 1023: Survival Analysis. All the lecture notes will provide an introduction to associated theory for the analysis of censored failure time data. Becuase this course mainly discuss the commonly-used methods with heuristic arguments and intuitive explanation of their properties, I will also include my own reading notes on incomplete observations and other types of continuous-time processes such as arise with competing risks data, multivariate failure time data, counting processes approaches, martingale and large-sample properties of estimators and tests, and some possible extensions.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Course Lecture Note" scheme="https://ShuHsienCho.github.io/categories/Course-Lecture-Note/"/>
    
    
      <category term="Lecture Note" scheme="https://ShuHsienCho.github.io/tags/Lecture-Note/"/>
    
  </entry>
  
  <entry>
    <title>Statistical Inference Note</title>
    <link href="https://shuhsiencho.github.io/posts/statinfnote/"/>
    <id>https://shuhsiencho.github.io/posts/statinfnote/</id>
    <published>2021-01-05T00:00:00.000Z</published>
    <updated>2021-06-06T07:31:30.291Z</updated>
    
    <content type="html"><![CDATA[<p>This lecture note is based on Rice STAT 532: Foundations of Statistical Inference I and Rice STAT 533: Foundations of Statistical Inference II. All the lecture notes will provide an advanced introduction to the mathematical theory of statistics, including comprehensive measure-theoretic probability, common families of distributions, statistical decision theory, statistics, and estimation.</p><a id="more"></a><h2 id="chapter-1-measure-space">Chapter 1: Measure Space</h2><p><a href="Ch1-Measure-Space.pdf">File</a></p><p>This chapter discusses measures and their definition, construction of functions and induced measures, integration and differentiation, and conditional expectation/distributions.</p><h2 id="chapter-2-probability-measures-on-euclidean-spaces">Chapter 2: Probability Measures on Euclidean Spaces</h2><p><a href="Ch2-Probability-Measures-on-Euclidean-Spaces.pdf">File</a></p><p>This chapter discusses the detailed properties of probability models on Euclidean spaces, moment inequalities, generating functions, distribution families, and order statistics.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This lecture note is based on Rice STAT 532: Foundations of Statistical Inference I and Rice STAT 533: Foundations of Statistical Inference II. All the lecture notes will provide an advanced introduction to the mathematical theory of statistics, including comprehensive measure-theoretic probability, common families of distributions, statistical decision theory, statistics, and estimation.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Course Lecture Note" scheme="https://ShuHsienCho.github.io/categories/Course-Lecture-Note/"/>
    
    
      <category term="Lecture Note" scheme="https://ShuHsienCho.github.io/tags/Lecture-Note/"/>
    
  </entry>
  
  <entry>
    <title>MD Anderson GSBS第一學期回顧</title>
    <link href="https://shuhsiencho.github.io/posts/mdacc20fall/"/>
    <id>https://shuhsiencho.github.io/posts/mdacc20fall/</id>
    <published>2020-12-13T08:30:00.000Z</published>
    <updated>2021-01-29T01:08:09.060Z</updated>
    
    <content type="html"><![CDATA[<p>在MD Anderson自閉的第一學期即將結束，在參與13-16號之間的ICSA Applied Statistics Symposiums之外，還得在16號考Rice統計推論一的期末考，接下來就是寒假的小休息與reset，在念書之餘想分享一下可能是在這學校最特別的一學期，也給自己一點回顧。</p><a id="more"></a><h2 id="core-course">Core Course</h2><p>這門課可以說是GSBS最重要的課程，也吃掉我最多時間，每天早上都需要上2.5小時的課外，每週也都有2個作業與1個journal club/debate等等。因為是umbrella program的緣故每一週都有不一樣的主題，我想從一個念統計/Quantitative Science的角度來看這門課。</p><h3 id="優點">優點</h3><p>因為要cover每週的主題，這門課找來MD Anderson / UT Medical School / BCM 等地的老師支援開課，對我來說是很新的上課體驗。而且因為不少老師都想收學生，因此上課也可能更認真，或者會推銷自己。此外每週一主題造成內容不會過分深入，相對來說則是更快的節奏，對於毫無基礎的我雖然仍屬辛苦，但是可以想像肯定比純粹的PhD level生物課更易上手。加上這學期其實也有不少內容是拿COVID來作為舉例甚至是當週的journal club / grant proposal主題，對於主題的投入更有感受（但希望我過了這學期不會真的忘光光就好）。此外這堂課的主軸也對bioinfo/statistical genetics的研究方向更為友好！</p><h4 id="translational-studies">Translational studies</h4><p>這門課其實某個程度上證實了這個學校是相對擅長轉譯研究的，很多時候我們都在看癌症相關的target gene以及mechanism/machinery，或者討論特定的pathway，有時候會要求我們基於以上的資訊設想一些有系統的小鼠實驗等等，這相當符合translational study的精神，也讓我了解到將來可能的合作對象是如何問出科學問題，只是並不會延伸到對於統計學家來說更容易協助的Phase 2以後的study，更多像是從bench的研究試圖延伸到病人的研究。</p><h3 id="缺點">缺點</h3><p>以生物統計的角度來看，這門課的幫助很有限，在前一個月的課程可以視為Genetic Epidemiology的生物背景知識。每週的journal club/指定閱讀文本也都有包含幾種基本的檢定或者存活分析甚至是視覺化，而這也是biostat/bioinfo課堂都有提及的，只是每週主題跟統計的整合效果不佳，這從每週的biostat作業同學的回答可以感受到。</p><p>此外在MDACC，不少的lab需要自己做single cell sequencing，且轉譯醫學本身應該也需要多學科的互相支援，但是這門課並沒有帶到與dry lab合作的必要性，多數在小組活動上的內容也都是以生物科學內容為主，並沒有讓生物背景的學生去嘗試問什麼時候需要量化，於是QS在這堂課中更像是另外一種突兀的存在。</p><p>最後則是非戰之罪--互動，這受制於當前疫情，這門課畢竟每天都要看到一樣的人2.5小時到中午，是一個很好讓同學互相交朋友的機會，甚至延伸到日後的合作，只是線上上課大大阻礙了可能性。</p><h2 id="rotation">Rotation</h2><p>這應該是對於統計學生來我們學校比較幸福的點，畢竟很少有人可以在一年級就開始做東西。相對於一個禮拜要五個半天的core course，這件事對我來說更熟悉。做了一些存活分析的variable selection同時估計的嘗試與實現，並且試圖用在UK biobank上，接下來希望寒假可以完成大部分的工作並且開始寫Technical report，只是想要同時在私底下多做一點東西的計劃並沒有很成功，可能在修課上多花了不少時間，希望下個學期在修課跟做研究上可以兼顧，並且下學期的rotation是有機會可以自己發展一些先前與老師討論過的想法，讓我更加期待！也要感謝Ryan給了蠻多想法跟建議，在這個特殊的情形與全新的環境中讓我仍然還算順利地活過這學期。</p><p>另外，在這裡似乎不用考慮「這真的用得到嗎？」「應用端在意嗎？」，更多時候就是因為有這些資料與現象才會冒出這些問題（或更準確的說，有這些Grant）而能夠更直接感受到該解決的問題。因此我猜想如果是即戰力到MD Anderson來唸書可能會很有收穫，這樣在一開始就可以決定好發展的走向，有研究經驗的幾個同學也是很快速地就把自己的rotation定好，這是對老師或者對學生都很有效率的做法，也可能是他們在入學審資料的時候會看Research statement的緣故，希望日後還能回來驗證這個猜想XD</p><h2 id="其他">其他</h2><p>多虧這裡選課自由，我能跨到Rice去上一些更深入的課程還是不錯（而且還不用多付錢），這樣可以讓訓練更多元又同時有深度，只是還有部分需要改善，特別是WFH的節奏沒有很順利，以及下學期相對更重的課程負擔，還有希望把下兩個rotation做得符合期待，應該會是更大的挑戰。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在MD Anderson自閉的第一學期即將結束，在參與13-16號之間的ICSA Applied Statistics Symposiums之外，還得在16號考Rice統計推論一的期末考，接下來就是寒假的小休息與reset，在念書之餘想分享一下可能是在這學校最特別的一學期，也給自己一點回顧。&lt;/p&gt;
    
    </summary>
    
    
      <category term="中文" scheme="https://ShuHsienCho.github.io/categories/%E4%B8%AD%E6%96%87/"/>
    
      <category term="心得分享" scheme="https://ShuHsienCho.github.io/categories/%E4%B8%AD%E6%96%87/%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB/"/>
    
    
      <category term="心得" scheme="https://ShuHsienCho.github.io/tags/%E5%BF%83%E5%BE%97/"/>
    
  </entry>
  
  <entry>
    <title>Encrypted article test</title>
    <link href="https://shuhsiencho.github.io/posts/7e709353/"/>
    <id>https://shuhsiencho.github.io/posts/7e709353/</id>
    <published>2020-11-06T16:14:11.000Z</published>
    <updated>2021-01-23T19:18:21.885Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Wrong password!" data-whm="Sorry, we cannot verify your information.">  <script id="hbeData" type="hbeData" data-hmacdigest="dbae9d1ef4bc2096428e9343535fc4e3fe60c07ef225b264f3b54e3942a5288a">4630436162ade97ba2718b7d0c4b3b63480c11f21f943edd569d93952dd2b42892dfbf6fb485b2d42bb78b95cad3282d1005bfd10618e6a253f3ffed39a7c6667e0ba01d51487801aba32262afb3e79ca37c3088bcd1bcdee4f5705b22865d319380a980be050100a4bbd113d31bcdc00e1997d2d9632516acb06ba8a15d633ffe77e3ba1cb4ab84175db72ef02bc1fa9b5916f45bdf66fe29e9d5718bf1e717431ef44d8a617418b5e46b870e4d0ea43362263ef1619f83e3645c2d889b9e68707039f5f38a6ee9383474f800b64a0a60ffb1659bf7e9e3b3824b028875513694bdf317a5aac0c516f34bf11ec567650887ba988a9528037268a62d08bd95f042da6b38e27f3dd8d1ea4e133673a54e498ee57697cd7ce72351ec514cfbde61cb98df28671d1bf5b677f68afb1cadd5bcee0e378e10c242d98a4ccb3b11e0c047c17a56733c07e60644c9d1a36b6a0da940acbf6f120439aa59be38d3d4224749b451fad57c5f7e9cf5cba4f73ff697515a34c3e46d799fff5e3d3ea6737a1e06e71123c5f6d1ac031e7a6f4c50e5537bfd9adb2fe50bf7060706c0c0520d5a68f4752e754403eb269acf37b8c685615a274a56841c80c6b6cd6face6baef0625a2d751b5860455bf13418cb3b9595e085349af9a2b2d61c1faf425c65f494df2786c8fb2eff30daa7a0376c930d1eb12ebbb0462401b4c6a61af7860fca2159abc06523546fd7ee64013443d52aaf13df6f6c8dbf375fcd769ecde26ef885d0cda0899ede643026ad3881e53cc36be999d0d5c937d89da81f70dac909d4663db7a131edf4458c3e91b2cf310371d29cd102874daa97c6e8ac02a8d000467fd981989a4c8e6f71d8fe46a5e946adaa8dd823f011f84192292b9b6321cddab04d5e4ca11d32293d7479b1ada515121a76982e460b9ec5aa45d50e37ab15c0c50</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Please try the password 123456.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      It&#39;s an encrypted article.
    
    </summary>
    
    
      <category term="private" scheme="https://ShuHsienCho.github.io/categories/private/"/>
    
    
      <category term="Encrypted" scheme="https://ShuHsienCho.github.io/tags/Encrypted/"/>
    
  </entry>
  
</feed>
